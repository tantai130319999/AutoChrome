window.onload=()=>{document.getElementById("autotube-skip-toggle").addEventListener("click",(function(t){setAutoTubeListeners("autoSkip")}));document.getElementById("loopButton").addEventListener("click",(function(t){document.getElementById("loopButton").toggleAttribute("active");setAutoTubeListeners("autoLoop")}));document.getElementById("shuffleButton").addEventListener("click",(function(t){document.getElementById("shuffleButton").toggleAttribute("active");setAutoTubeListeners("autoShuffle")}));setSettings([{key:"autoSkip",cb:setAutoSkip},{key:"autoLoop",cb:setAutoLoop},{key:"autoShuffle",cb:setAutoShuffle}]);setAppStatus()};function setSettings(t){chrome.storage.sync.get(null,(function(e){const o={};t.forEach(({key:t,cb:n})=>{if(e===undefined||e[t]===undefined||e[t]===null){o.key=n(true)}else if(!e[t]){n(false)}else{n(true)}});Object.keys(o).length>0&&chrome.storage.sync.set(o,(function(){}))}))}function setAutoTubeListeners(t){const e={autoSkip:document.getElementById("autotube-skip-toggle").checked,autoLoop:document.getElementById("loopButton").hasAttribute("active"),autoShuffle:document.getElementById("shuffleButton").hasAttribute("active")}[t];chrome.tabs.query({url:["https://www.youtube.com/*","https://music.youtube.com/*","https://m.youtube.com/*"]},o=>{for(let n of o){console.log(n,{[t]:e});chrome.tabs.sendMessage(n.id,{[t]:e})}});chrome.storage.sync.set({[t]:e})}function setAutoShuffle(t){return document.getElementById("shuffleButton").toggleAttribute("active",t)}function setAutoLoop(t){return document.getElementById("loopButton").toggleAttribute("active",t)}function setAutoSkip(t){return document.getElementById("autotube-skip-toggle").toggleAttribute("checked",t)}async function setAppStatus(){let t="<ok>running</ok>";let e=[];try{let o=await fetch("https://appstatus.netlify.app/.netlify/functions/api/autotube").then(t=>t.json());t=o.status||t;e=o.updates||e}catch(t){}document.getElementById("status").innerHTML=t;if(e.length){for(let t of[e].flat()){document.getElementById("updates").innerHTML+=`<p>${t}</p>`}}document.getElementById("version").append(`V${chrome.runtime.getManifest().version}`)}
var chrome=window.chrome?chrome:browser,isFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,_arp_assignKeys={},_arp_hotkeysEnable=!1;function inject(){function e(e){var t,n,o;if(n=[],o=e.attributes){for(t=0;t<o.length;++t)n.push(o[t].nodeName);n.sort()}return n}var t="",n=null;function o(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return null}function r(e,t,n){var o=window.location.hostname;if(n>0){var r=new Date;r.setTime(r.getTime()+60*n*60*1e3);var a="; expires="+r.toGMTString()}else if(-1==n)a="; expires="+(new Date).toGMTString()+"; max-age=0";else a="";document.cookie=e+"="+encodeURIComponent(t)+a+"; path=/; domain="+o}function a(e){return-1===e.indexOf('"')?'"'+e+'"':-1===e.indexOf("'")?"'"+e+"'":'concat("'+e.replace(/"/g,'",\'"\',"')+'")'}function s(e){let t=document.createElement("div");return t.innerHTML=e,t}function i(o){let r=document.body.innerHTML,a=o.pm_options,i={element:null,type:null,key:"Any"};if(r!=o.instance){(function o(r,a,s){var i,l,u,c,d;if(i=e(r),l=e(a),i.join(",")!==l.join(",")&&1==s.source)return t="source",n=document.body,!1;for(index=0;index<i.length;++index)if(u=i[index],a.getAttribute&&r.getAttribute&&r.getAttribute(u)!==a.getAttribute(u)&&1==s.source)return t="source",n=document.body,!1;for(c=r.firstChild,d=a.firstChild;c&&d;c=c.nextSibling,d=d.nextSibling)if(c.nodeType,d.nodeType,1===c.nodeType){if(!o(c,d,s))return!1}else if(c.nodeValue!==d.nodeValue)if(c.parentNode){if("SCRIPT"==c.parentNode.nodeName||"STYLE"==c.parentNode.nodeName){if(1==s.source)return t="source",n=c.parentNode||document.body,!1}else if(1==s.visual)return t="s_visual",n=c.parentNode,!1}else if(1==s.source)return t="source",n=document.body,!1;return!0})(s(document.body.innerHTML),s(o.instance),a)||(i.element=n,i.type=t,i.key="any")}return chrome.runtime.sendMessage({name:"anychange",body:document.body.innerHTML},null),i}function l(e,t){let n,o,r,s=e.split("[^or]");try{const e=function(e){let t=e.toLowerCase(),n=e.toUpperCase();return`//*[contains(  translate( text(), ${n}, ${t}) , ${t}) or contains(  translate( @value, ${n}, ${t}) , ${t})]`},i=function(e){let t=e.toLowerCase();return`//text()[contains(  translate( ., ${e.toUpperCase()}, ${t}) , ${t})]`},l=e=>(e=e.replace("$","")).match(/\/(.+)\/.*/);s.some((s,u)=>{if("##"===s.substring(0,2)){const e=function(e){if(!e)return!1;var t,n=e.match(/\(([^)]+)\)/g),o=function(e){for(var t=(e=e.replace(/^\s+/,"")).length-1;t>=0;t--)if(/\S/.test(e.charAt(t))){e=e.substring(0,t+1);break}return e};if(n[0]&&n[1]){for(var r=/\(([^)]*)\)/.exec(n[0])[1].split("|"),a=/\(([^)]*)\)/.exec(n[1])[1].split("|"),s="",i="",l=0;l<r.length;l++)s+=`//*[contains( text() , "${o(r[l])}")]`,l+1<r.length&&(s+=" or ");for(l=0;l<a.length;l++)i+=`//*[contains( text() , "${o(a[l])}")]`,l+1<a.length&&(i+=" or ");t=`(${s}) and (${i})`}else{if(!n[0])return!1;for(r=/\(([^)]*)\)/.exec(n[0])[1].split("|"),s="",l=0;l<r.length;l++)s+=`//*[contains( text() , "${o(r[l])}")]`,l+1<r.length&&(s+=" or ");t=`${s}`}return t}(s.replace("##",""));if(!e)return;return document.evaluate(e,document,null,XPathResult.ANY_TYPE,null).booleanValue?(n="s_visual",r=document,o=s,!0):void 0}if("$"===s.substring(0,1)&&l(s)){const e=(e=>{const t=e.match(/\/(.+)\/.*/)[1],n=e.match(/\/.+\/(.*)/)[1];return new RegExp(t,n)})(s.replace("$","").toLowerCase());return document.body.innerText.toLowerCase().match(e)?(n="s_visual",r=document,o=s,!0):void 0}if("@@"!==s.substring(0,2)){for(evl=i(a(s)),matchingElement=document.evaluate(evl,document,null,XPathResult.ANY_TYPE,null);node=matchingElement.iterateNext();)if(node.parentElement.offsetParent&&"none"!=node.parentElement.style.display&&1==t.visual)return n="visual",r=node.parentElement,o=s,!0;for(evl=e(a(s)),matchingElement=document.evaluate(evl,document,null,XPathResult.ANY_TYPE,null);node=matchingElement.iterateNext();)if("SCRIPT"==node.tagName||"STYLE"==node.tagName){if(1==t.source){n="source",r=node,o=s;break}}else if(node.offsetParent&&"none"!=node.style.display){if(1==t.visual){n="visual",r=node,o=s;break}}else if(0==t.visual){n="novisual",r=node,o=s;break}}else{let e=document.evaluate(s.replace("@@",""),document,null,XPathResult.ANY_TYPE,null);if(3==e.resultType){if(e.booleanValue)return n="s_visual",r=document,o=s,!0}else for(;node=e.iterateNext();)if("SCRIPT"==node.tagName||"STYLE"==node.tagName){if(1==t.source)return n="source",r=node,o=s,!0}else if(node.offsetParent&&"none"!=node.style.display){if(1==t.visual)return n="s_visual",r=node,o=s,!0}else if(1==t.source)return n="source",r=node,o=s,!0}})}catch(e){console.log("Error: invalid expression: ",e)}return{element:r,type:n,key:o}}function u(e){return e&&e[0].toUpperCase()+e.slice(1)}(isFirefox?chrome.runtime:chrome.extension).onMessage.addListener(function(e,t,n){if("A"==e.pattern){document.body.getElementsByTagName("*");var o="",a="no";let t=!1,r="";if(1==e.autoclick&&(s='window.open = (s) => { window.postMessage({ type: "openWindow", value: s, inNewTab: '+e.inNewTab+'}, "*"); }',c=s,d=document.createElement("script"),m=document.createTextNode(c),d.appendChild(m),document.body.append(d)),""==e.checkme&&e.pm_options&&"1"==e.pm_options.type)return n({});let p="2"==e.pm_options.type?i(e):l(e.checkme,e.pm_options);p&&p.element&&(a="yes",r=u(p.key.replaceAll('"',"")),"visual"!=p.type&&"s_visual"!=p.type||("visual"==p.type&&((e,t)=>{let n=e.innerHTML,o=t,r=n.indexOf(o);r>=0&&(n=n.substring(0,r)+"<span style='background-color: #F7E706 !important;'>"+n.substring(r,r+o.length)+"</span>"+n.substring(r+o.length),e.innerHTML=n)})(p.element,r),1==e.autoclick&&"#document"!=p.element.nodeName&&(null!=p.element.closest("a")?o=p.element.closest("a").href:(p.element.click(),t=!0)))),"yes"==a?t?n({findresult:"yes",url:null,keyword:r}):e.inNewTab&&1==e.autoclick?n({findresult:"yes",url:o,keyword:r}):(n({findresult:"yes",keyword:r}),1==e.autoclick&&setTimeout(()=>{location.href=o},100)):n({})}else if("B"==e.pattern){let t=!1,o="";if("2"==e.pm_options.type){let n=i(e);n&&n.element&&(t=!0)}else{e.checkme.split("[^or]").some(n=>{l(n,e.pm_options).element||(o=u(n.replaceAll('"',"")),t=!0)})}n(t?{findresult:"yes",keyword:o}:{})}else if("C"==e.pattern)r("arp_scroll_switch","1",12);else if("ANY"==e.pattern)e.options.pmOptions&&"2"==e.options.pmOptions.type&&n({body:document.body.innerHTML});else if("D"==e.pattern)r("arp_scroll_switch","0",-1),r("arp_scroll_position",0,-1);else if("E"==e.pattern){let t="no",o=l(e.words,{visual:!0,source:!1});o&&o.element&&(t="yes"),n({predefinedText:t})}var s,c,d,m});var c=o("arp_scroll_switch");if(c&&"1"==c){var d=o("arp_scroll_position");window.scrollTo(0,d)}window.addEventListener("scroll",function(){r("arp_scroll_position",window.pageYOffset,6)},!1),chrome.runtime.onMessage.addListener(function(e){"updateFromARP"==e&&updateData(),"location_replace"==e.name&&window.location.replace(e.data)}),document.URL.indexOf("blank.html")>-1&&window.history.back()}function updateData(){chrome.runtime.sendMessage({name:"getHotkeys"},function(e){e&&("true"==e.hotkeys&&(_arp_hotkeysEnable=!0),_arp_hotkeysEnable&&(_arp_assignKeys={},e.startTime&&(_arp_assignKeys[e.startTime]="startTime"),e.startRandom&&(_arp_assignKeys[e.startRandom]="startRandom"),e.startTimer&&(_arp_assignKeys[e.startTimer]="startTimer"),e.stoptTime&&(_arp_assignKeys[e.stoptTime]="stoptTime"),e.killSound&&(_arp_assignKeys[e.killSound]="killSound")))})}window.addEventListener("message",function(e){e.source==window&&(e.data.type,"openWindow"==e.data.type&&(e.data.inNewTab?chrome.runtime.sendMessage({name:"opentab",url:e.data.value},null):location.href=e.data.value))}),chrome.runtime.sendMessage({name:"getHotkeys"},function(e){if(e&&("true"==e.hotkeys&&(_arp_hotkeysEnable=!0),_arp_hotkeysEnable)){e.startTime&&(_arp_assignKeys[e.startTime]="startTime"),e.startRandom&&(_arp_assignKeys[e.startRandom]="startRandom"),e.startTimer&&(_arp_assignKeys[e.startTimer]="startTimer"),e.stoptTime&&(_arp_assignKeys[e.stoptTime]="stoptTime"),e.killSound&&(_arp_assignKeys[e.killSound]="killSound");let t=[];document.addEventListener("keydown",function(e){if("INPUT"==e.target.tagName||"TEXTAREA"==e.target.tagName)return;-1==t.indexOf("["+e.key+"]")&&t.push("["+e.key+"]");let n=_arp_assignKeys[t.toString()];if(n)try{e.preventDefault(),e.stopPropagation(),chrome.runtime.sendMessage({name:"hotKeyFunction",value:n},function(){chrome.runtime.lastError})}catch(e){alert(e),location.reload()}}),document.addEventListener("keyup",function(e){t=[]})}});try{document.documentElement.hasAttribute("data-arp-injected")||(document.documentElement.setAttribute("data-arp-injected","true"),inject())}catch(e){}